# 📘 开发指南（ButtonAssist）

本文档概述了各个 `.ahk` 模块的职责与作用，方便开发者快速理解项目结构与功能。

---

## 📂 主程序入口

### `RMT.ahk`
**功能概述：**  
程序的主入口，负责初始化与启动。

**职责内容：**
- 加载核心库与自定义脚本
- 初始化文件路径（配置文件、日志等）
- 加载用户配置文件
- 监听右键点击以编辑宏数据
- 初始化软件内部数据（数据缓存、状态等）
- 初始化主界面 UI
- 绑定全局快捷键与热键功能

---

## 🖥️ 用户界面模块

### `UIUtil.ahk`
**功能概述：**  
主界面模板，负责构建和控制所有主窗口相关的 UI 元素。

**职责内容：**
- 主窗口布局与样式
- 按钮、标签、输入框等控件的初始化与事件绑定
- 与数据逻辑进行简单交互以展示信息

---

## 🧠 数据结构模块

### `DataClass.ahk`
**功能概述：**  
定义程序中用到的数据结构与宏指令的数据模型。

**职责内容：**
- 宏指令对象的定义（名称、触发键、动作序列等）
- 全局配置对象（如主题、快捷键映射、用户偏好设置）
- 序列化/反序列化方法（用于保存与加载配置）
- 工具函数用于处理数据逻辑（如合并、比较、查找等）

---

## 🛠 宏编辑界面模块

### `MacroEditGui.ahk`
**功能概述：**  
编辑宏指令的专用 UI，支持用户自定义宏逻辑。

**职责内容：**
- 编辑界面的布局与控件初始化
- 支持多步骤宏指令添加/删除/排序
- 提供“录制按键”、“插入延时”等便捷功能
- 界面与数据结构交互，实时更新预览结果

---

## 🎹 热键与宏指令处理模块

### `HotKeyUtil.ahk`
**功能概述：**  
实现全局热键注册、监听与宏指令执行逻辑。

**职责内容：**
- 注册用户设置的热键（系统级热键）
- 触发宏指令的执行逻辑
- 支持常用动作（按键模拟、延时、鼠标点击等）
- 处理宏执行流程，包括错误处理与中断机制

---

## 🎨 资源处理模块

### `AssetUtil.ahk`
**功能概述：**  
统一管理资源（如图标、配置文件等）的加载、保存与转换。

**职责内容：**
- 加载本地资源（图像、图标、模板等）  
- 保存用户生成的数据（例如宏配置文件）  
- 文件路径处理与统一资源引用接口 

---

## 🆕 新指令添加流程（以“开源”指令 OpenSource 为例）
    如果你想新增指令参考以下流程
1. **新增数据保存文件路径**  
   在 `AssetUtil.ahk` 的 `InitFilePath` 函数中添加：  
   ```ahk
   global OpenSourceFile := A_WorkingDir "\Setting\OpenSourceSettings.ini"
   ```

2. **定义指令数据结构**  
   在 `DataClass.ahk` 中新增结构体 `OpenSourceData`，类似已有的 `FileData`。  
   重点字段：  
   - `SerialStr`：指令序列化标识，必须唯一，用于区分不同指令。  
   - 其他参数根据指令需求定义。

3. **新增指令编辑界面**  
   - 复制现有的 `FileGui.ahk`，重命名为 `OpenSourceGui.ahk`。  
   - 修改类名和内部所有涉及 `FileFile` 的变量为 `OpenSourceFile`。  
   - 实现 `GetCommandStr()` 返回指令名称 `"开源"`。  
   - 根据指令参数调整 `AddGui()` 和相关接口，确保界面能编辑对应参数。

4. **添加指令按钮入口**  
   - 在 `MacroEditGui.ahk` 中新增按钮，调用 `OpenSourceGui.ahk` 以打开编辑界面。  
   - 参考已有“文件”按钮实现。

5. **实现指令执行逻辑**  
   - 在 `HotKeyUtil.ahk` 的 `OnTriggerMacroOnce` 中添加对 `OpenSource` 指令的处理逻辑。  
   - 复杂指令可参考“按键”指令实现，简单指令参考“文件”指令。

---
